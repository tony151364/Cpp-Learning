# 5 表
- 表（Table）是Lua语言中最主要（事实也是唯一的）和强大的数据结构
- Lua语言也可以用表来表示包（package）和其他对象。
- math.sin的实际含义是“以字符串sin为键检索表math

- Lua语言中的表本质上是一种辅助数组（assicuative array），这种数组不仅可以使用数值所谓索引，也可以使用字符串或者其他任意类型的值作为索引（nil除外）

- 表中的值要么是变量，要么是*对象（object）*。
- 可以认为，表是一种动态分配的对象，程序智能操作指向表的引用（或指针）
- Lua不会使用深拷贝或创建新的表
- 对于一个表而言，当程序中不再有指向它的引用时，垃圾收集器会最终删除这个表重用其占用的内存。

## 5.1 表索引
```lua
> -- 创建1000个新元素
> for i = 1, 1000 do a[i] = i*2 end
> a["x"] = 10
> a["x"]   --> 10
> a["y"]   --> nil
```
请注意上述代码的最后一行：如同全局变量一样，未经初始化的表元素为nil，将nil赋值给表元素可以将其删除。这并非巧合，因为Lua语言实际上就是使用表来存储全局变量的（详见第22章）

- 可以把表当结构体使用（a.name 等价于 a["name"]）
- 对于Lua来说，两种形式等价且可以自由混用。但可能意图不同：
 - a.name清晰说明表被当做结构体使用。此时表实际是由固定的、预先定义的键组成的集合。
 - a["name"]的字符串索引形式则说明了表可以使用任意字符串作为键，我们操作指定的键。
 
- 当不能确定表索引的真实数据类型时，可以使用显式的类型转换
> a[tonumber(j)] --> 数值类型的键

- 整型和浮点型不存在这个问题，因为2和2.0的值相等。
- 更准确来说，任何能被转换为整型的浮点数都会被转换成整数型。执行a[2.0] = 10时，键2.0会被转换为2

## 5.2 表构造器（Table Constructor）
- 使用合适的构造其创建表会更加高效和易读
- Lua还提供了一种初始化记录式（record-like）表的特殊语法：
```lua
> a = {x = 10, y = 20}
-- 上述代码等价于
> a = {}; a.x = 10; a.y = 20;
```
- 不过在第一种写法中，由于能提前判断表的大小，所以运行速度更快。

- 可以混用记录式（record-style）和列表式（list-style）写法。嵌套表
